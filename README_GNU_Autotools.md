Filename : README_GNU_Autotools.md


## 1) Introduction.

GNU Autoconf macros can be classified as being either non configurable or configurable. But what does this mean exactly? To help try and explain the difference between the two categories, the next section will discuss each of them in turn.


## 2) Non configurable and configurable macros.

Let us first consider non configurable macros. After we are done discussing them, we will then turn
our attention to configurable macros.


### 2.1) Non configurable macros.

Consider the definition of the following non configurable GNU Autoconf macro.

```
01 AC_DEFUN(
02
03  [AX_TEST_MACRO],
04
05   [
06     # Set the variable and then instruct GNU Autoconf to register it with the
07     # configure script which GNU Autoconf will generate.
08     #
09     # If the variable isn't registered, then it won't be able to be seen or be
10     # used by other code outside of this macro.
11
12     TEST_MACRO_VARIABLE="Hello, World!"
13
14     AC_SUBST([TEST_MACRO_VARIABLE])
15   ]
16 )
```
> Code listing no. 1

This GNU Autoconf macro - which from now onwards will simply be referred to as a macro, is very basic in its nature. It doesn't do anything more than what its comments state; and that is to set the value of the variable named ```TEST_MACRO_VARIABLE``` and then register it, so that the variable can be seen and used by other code outside of the macro.

As was stated above, the macro which is defined in Code listing no. 1 implements a non configurable macro. This shouldn't come as a massive surprise, as there isn't anything in the body of the macro code for a potential user of the macro to configure! The macro itself sets the value of the variable, and then registers that same variable with GNU Autoconf. There is no way for a user of this macro to set the value of the variable ```TEST_MACRO_VARIABLE```, whether it be a Package maintainer or a Package user. Not only that, there is no way to pass configuration information into this macro in the first place, because the macro doesn't contain any functionality which allows it to do so. So this is what is meant, when the macro is referred to as being non configurable.

Since this macro is non configurable, it doesn't provide any command line information on how to use it; afterall, it doesn't need to. That is, if a package uses this macro, and a user of this same package invokes its configure script with the ```--help``` command line option, then the user won't receive any information on how to use this macro. The following output was generated by invoking the configure script - with the ```--help``` command line option, for a project which makes use of the ```AX_TEST_MACRO```. 

```
001 `configure' configures SimpleAutotoolsProject 0.0.1 to adapt to many kinds of systems.
002
003 Usage: ./configure [OPTION]... [VAR=VALUE]...
004
005 To assign environment variables (e.g., CC, CFLAGS...), specify them as
006 VAR=VALUE.  See below for descriptions of some of the useful variables.
007
008 Defaults for the options are specified in brackets.
009
010 Configuration:
011   -h, --help              display this help and exit
012       --help=short        display options specific to this package
013       --help=recursive    display the short help of all the included packages
014   -V, --version           display version information and exit
015   -q, --quiet, --silent   do not print `checking ...' messages
016       --cache-file=FILE   cache test results in FILE [disabled]
017   -C, --config-cache      alias for `--cache-file=config.cache'
018   -n, --no-create         do not create output files
019       --srcdir=DIR        find the sources in DIR [configure dir or `..']
020
021 Installation directories:
022   --prefix=PREFIX         install architecture-independent files in PREFIX
023                           [/usr/local]
024   --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
025                           [PREFIX]
026
027 By default, `make install' will install all the files in
028 `/usr/local/bin', `/usr/local/lib' etc.  You can specify
029 an installation prefix other than `/usr/local' using `--prefix',
030 for instance `--prefix=$HOME'.
031
032 For better control, use the options below.
033
034 Fine tuning of the installation directories:
035   --bindir=DIR            user executables [EPREFIX/bin]
036   --sbindir=DIR           system admin executables [EPREFIX/sbin]
037   --libexecdir=DIR        program executables [EPREFIX/libexec]
038   --sysconfdir=DIR        read-only single-machine data [PREFIX/etc]
039   --sharedstatedir=DIR    modifiable architecture-independent data [PREFIX/com]
040   --localstatedir=DIR     modifiable single-machine data [PREFIX/var]
041   --runstatedir=DIR       modifiable per-process data [LOCALSTATEDIR/run]
042   --libdir=DIR            object code libraries [EPREFIX/lib]
043   --includedir=DIR        C header files [PREFIX/include]
044   --oldincludedir=DIR     C header files for non-gcc [/usr/include]
045   --datarootdir=DIR       read-only arch.-independent data root [PREFIX/share]
046   --datadir=DIR           read-only architecture-independent data [DATAROOTDIR]
047   --infodir=DIR           info documentation [DATAROOTDIR/info]
048   --localedir=DIR         locale-dependent data [DATAROOTDIR/locale]
049   --mandir=DIR            man documentation [DATAROOTDIR/man]
050   --docdir=DIR            documentation root [DATAROOTDIR/doc/simplescanner]
051   --htmldir=DIR           html documentation [DOCDIR]
052   --dvidir=DIR            dvi documentation [DOCDIR]
053   --pdfdir=DIR            pdf documentation [DOCDIR]
054   --psdir=DIR             ps documentation [DOCDIR]
055
056 Program names:
057   --program-prefix=PREFIX            prepend PREFIX to installed program names
058   --program-suffix=SUFFIX            append SUFFIX to installed program names
059   --program-transform-name=PROGRAM   run sed PROGRAM on installed program names
060
061 System types:
062   --build=BUILD     configure for building on BUILD [guessed]
063   --host=HOST       cross-compile to build programs to run on HOST [BUILD]
064
065 Optional Features:
066   --disable-option-checking  ignore unrecognized --enable/--with options
067   --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
068   --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
069   --enable-silent-rules   less verbose build output (undo: "make V=1")
070   --disable-silent-rules  verbose build output (undo: "make V=0")
071   --enable-dependency-tracking
072                           do not reject slow dependency extractors
073   --disable-dependency-tracking
074                           speeds up one-time build
075   --enable-shared[=PKGS]  build shared libraries [default=yes]
076   --enable-static[=PKGS]  build static libraries [default=yes]
077   --enable-fast-install[=PKGS]
078                           optimize for fast installation [default=yes]
079   --disable-libtool-lock  avoid locking (might break parallel builds)
080
081 Optional Packages:
082   --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
083   --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
084   --with-pic[=PKGS]       try to use only PIC/non-PIC objects [default=use
085                           both]
086   --with-aix-soname=aix|svr4|both
087                           shared library versioning (aka "SONAME") variant to
088                           provide on AIX, [default=aix].
089   --with-gnu-ld           assume the C compiler uses GNU ld [default=no]
090   --with-sysroot[=DIR]    Search for dependent libraries within DIR (or the
091                           compiler's sysroot if not specified).
092
093 Some influential environment variables:
094   CC          C compiler command
095   CFLAGS      C compiler flags
096   LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
097               nonstandard directory <lib dir>
098   LIBS        libraries to pass to the linker, e.g. -l<library>
099   CPPFLAGS    (Objective) C/C++ preprocessor flags, e.g. -I<include dir> if
100               you have headers in a nonstandard directory <include dir>
101   CXX         C++ compiler command
102   CXXFLAGS    C++ compiler flags
103   YACC        The `Yet Another Compiler Compiler' implementation to use.
104               Defaults to the first program found out of: `bison -y', `byacc',
105               `yacc'.
106   YFLAGS      The list of arguments that will be passed by default to $YACC.
107               This script will default YFLAGS to the empty string to avoid a
108               default value of `-d' given by some make applications.
109   LT_SYS_LIBRARY_PATH
110               User-defined run-time library search path.
111   CPP         C preprocessor
112   CXXCPP      C++ preprocessor
113
114 Use these variables to override the choices made by `configure' or to help
115 it to find libraries and programs with nonstandard names/locations.
116
117 Report bugs to the package provider.
```
> configure --help output no. 1

Note in the ```Optional Features:``` section of the output on lines 66 -> 79, and also the ```Optional Packages:``` section of the output on lines 82 -> 91, that there is no mention of how to use the ```AX_TEST_MACRO``` macro. 

### 2.2) Configurable macros.

If the macro which was listed above in Code listing no. 1, might require configuration information to be passed to it, then it should have additional code added to it which will allow it to facilitate this functionality. At a bare minimum, this additional code should invoke the GNU Autoconf ```AC_ARG_WITH``` macro, in a manner which is similar to that shown in lines 6 -> 16 below. 

```
01 AC_DEFUN(
02
03  [AX_TEST_MACRO],
04
05  [
06     AC_ARG_WITH(
07       [test-macro],
08       [
09 AS_HELP_STRING(
10 [--with-value=@<:@variable_value@:>@],
11 [instruct the macro to set the variable to the specified value]
12 )
13       ],
14       [TEST_MACRO_VARIABLE=${withval}],
15       [TEST_MACRO_VARIABLE="Hello, World!"]
16     )
17
18     # The call to AC_ARG_WITH will have set the value of the variable
19     # TEST_MACRO_VARIABLE.
20
21     # Instruct GNU Autoconf to register the variable with the configure script.
22     #
23     # If the variable isn't registered, then it won't be able to be seen or be
24     # used by other code outside of this macro.
25
26     AC_SUBST([TEST_MACRO_VARIABLE])
27   ]
28 )
```
> Code listing no. 2

A point needs to be made about the the code which is listed above, and that is with regard to the alignment of the ```AS_HELP_STRING``` macro. Notice how the call to this macro does not lineup with the surrounding code in respect to indentation; that is, it is not preceded by any whitespace. If it were, then the configure script help string which is associated with the ```AX_TEST_MACRO``` would appear out of alignment when a user invokes ```configure --help``` on any package which uses this macro.

```
001 `configure' configures SimpleScanner 0.0.1 to adapt to many kinds of systems.
002
003 Usage: ./configure [OPTION]... [VAR=VALUE]...
004
005 To assign environment variables (e.g., CC, CFLAGS...), specify them as
006 VAR=VALUE.  See below for descriptions of some of the useful variables.
007
008 Defaults for the options are specified in brackets.
009
010 Configuration:
011   -h, --help              display this help and exit
012       --help=short        display options specific to this package
013       --help=recursive    display the short help of all the included packages
014   -V, --version           display version information and exit
015   -q, --quiet, --silent   do not print `checking ...' messages
016       --cache-file=FILE   cache test results in FILE [disabled]
017   -C, --config-cache      alias for `--cache-file=config.cache'
018   -n, --no-create         do not create output files
019       --srcdir=DIR        find the sources in DIR [configure dir or `..']
020
021 Installation directories:
022   --prefix=PREFIX         install architecture-independent files in PREFIX
023                           [/usr/local]
024   --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
025                           [PREFIX]
026
027 By default, `make install' will install all the files in
028 `/usr/local/bin', `/usr/local/lib' etc.  You can specify
029 an installation prefix other than `/usr/local' using `--prefix',
030 for instance `--prefix=$HOME'.
031
032 For better control, use the options below.
033
034 Fine tuning of the installation directories:
035   --bindir=DIR            user executables [EPREFIX/bin]
036   --sbindir=DIR           system admin executables [EPREFIX/sbin]
037   --libexecdir=DIR        program executables [EPREFIX/libexec]
038   --sysconfdir=DIR        read-only single-machine data [PREFIX/etc]
039   --sharedstatedir=DIR    modifiable architecture-independent data [PREFIX/com]
040   --localstatedir=DIR     modifiable single-machine data [PREFIX/var]
041   --runstatedir=DIR       modifiable per-process data [LOCALSTATEDIR/run]
042   --libdir=DIR            object code libraries [EPREFIX/lib]
043   --includedir=DIR        C header files [PREFIX/include]
044   --oldincludedir=DIR     C header files for non-gcc [/usr/include]
045   --datarootdir=DIR       read-only arch.-independent data root [PREFIX/share]
046   --datadir=DIR           read-only architecture-independent data [DATAROOTDIR]
047   --infodir=DIR           info documentation [DATAROOTDIR/info]
048   --localedir=DIR         locale-dependent data [DATAROOTDIR/locale]
049   --mandir=DIR            man documentation [DATAROOTDIR/man]
050   --docdir=DIR            documentation root [DATAROOTDIR/doc/simplescanner]
051   --htmldir=DIR           html documentation [DOCDIR]
052   --dvidir=DIR            dvi documentation [DOCDIR]
053   --pdfdir=DIR            pdf documentation [DOCDIR]
054   --psdir=DIR             ps documentation [DOCDIR]
055
056 Program names:
057   --program-prefix=PREFIX            prepend PREFIX to installed program names
058   --program-suffix=SUFFIX            append SUFFIX to installed program names
059   --program-transform-name=PROGRAM   run sed PROGRAM on installed program names
060
061 System types:
062   --build=BUILD     configure for building on BUILD [guessed]
063   --host=HOST       cross-compile to build programs to run on HOST [BUILD]
064
065 Optional Features:
066   --disable-option-checking  ignore unrecognized --enable/--with options
067   --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
068   --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
069   --enable-silent-rules   less verbose build output (undo: "make V=1")
070   --disable-silent-rules  verbose build output (undo: "make V=0")
071   --enable-dependency-tracking
072                           do not reject slow dependency extractors
073   --disable-dependency-tracking
074                           speeds up one-time build
075   --enable-shared[=PKGS]  build shared libraries [default=yes]
076   --enable-static[=PKGS]  build static libraries [default=yes]
077   --enable-fast-install[=PKGS]
078                           optimize for fast installation [default=yes]
079   --disable-libtool-lock  avoid locking (might break parallel builds)
080
081 Optional Packages:
082   --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
083   --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
084   --with-pic[=PKGS]       try to use only PIC/non-PIC objects [default=use
085                           both]
086   --with-aix-soname=aix|svr4|both
087                           shared library versioning (aka "SONAME") variant to
088                           provide on AIX, [default=aix].
089   --with-gnu-ld           assume the C compiler uses GNU ld [default=no]
090   --with-sysroot[=DIR]    Search for dependent libraries within DIR (or the
091                           compiler's sysroot if not specified).
092
093   --with-value[=ARG]      instruct the macro to set the variable to the
094                           specified value
095
096 Some influential environment variables:
097   CC          C compiler command
098   CFLAGS      C compiler flags
099   LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
100               nonstandard directory <lib dir>
101   LIBS        libraries to pass to the linker, e.g. -l<library>
102   CPPFLAGS    (Objective) C/C++ preprocessor flags, e.g. -I<include dir> if
103               you have headers in a nonstandard directory <include dir>
104   CXX         C++ compiler command
105   CXXFLAGS    C++ compiler flags
106   YACC        The `Yet Another Compiler Compiler' implementation to use.
107               Defaults to the first program found out of: `bison -y', `byacc',
108               `yacc'.
109   YFLAGS      The list of arguments that will be passed by default to $YACC.
110               This script will default YFLAGS to the empty string to avoid a
111               default value of `-d' given by some make applications.
112   LT_SYS_LIBRARY_PATH
113               User-defined run-time library search path.
114   CPP         C preprocessor
115   CXXCPP      C++ preprocessor
116
117 Use these variables to override the choices made by `configure' or to help
118 it to find libraries and programs with nonstandard names/locations.
119
120 Report bugs to the package provider.
```
> configure --help output no. 2

Note in the ```Optional Packages:``` section of the output on line 93, that there is now a mention of how to use the AX_TEST_MACRO macro.

## 2) Using the macro.

Broadly speaking, people who will use this macro - or any GNU Autoconf macro for that matter, can be divided up into two categories, depending upon how they use the macros. They can be categorised as using macros either indirectly or directly.

  1) Indirect users of macros -> Package maintainers
  2) Direct users of macros   -> Package users

#### Package maintainers.

Package maintainers can be thought of as using macros in an indirect sense. What this means is that they don't actually execute or run the macros - rather, they just reference them in the ```configure.ac``` files that they write for their package. Even when a Package maintainer uses GNU Autoconf to generate a configure script for their package, they are still not executing or running the macros. All that GNU Autoconf is actually doing is copying the code for the macros into the package's resulting configure script.

#### Package users.

Package users on the other hand, can be thought of as using macros in a direct sense. What this means is that they do actually execute or run the macos. When a Package user runs a package's configure script, they will be directly executing any macros that have been referenced by that package's ```configure.ac``` file.


### 2.1) Package maintainers : The people who reference this macro.

If a Package maintainer wanted to use the ```AX_TEST_MACRO``` macro in their particular package, then the macro will need to be referenced from within their package's ```configure.ac``` file. This can be done in a manner which is similar to the following;

```
AX_TEST_MACRO()
```

Once a package's ```configure.ac``` file has been finalised, the Package maintainer should generate a configure script for the package, using the GNU Autotools ```autoreconf``` command to do so.

When a Package maintainer is ready to distribute their package to users, all of the files which are to form the package should be "rolled up" into an archive file for ease of distribution. It is these archive files which form the actual package for the project, and a key file in any package should be its configure script.


### 2.2) Package users : The people who execute this macro.

#### 2.2.1) Macros that can't be configured.

When the user of this package executes its configure script with the ```--help``` command line option, the user won't see any information on how to use this macro.


#### 2.2.2) Macros that can be configured.